# .titan/workflows/create-pr-ai.yaml
# This workflow overrides the default one from the github plugin.

name: "Create Pull Request with AI + Linter"
description: "AI-powered PR creation with an additional linting step for this project."

# Extend the base workflow from the github plugin
extends: "plugin:github/create-pr-ai"

# Use hooks to inject custom steps
hooks:
  before_commit:
    - id: ruff-lint
      name: "Run Ruff Linter"
      plugin: project
      step: ruff_linter
      on_error: continue  # Continue to AI step even if linting finds issues

    - id: ai-help
      name: "AI Code Assistant"
      plugin: core
      step: ai_code_assistant
      params:
        context_key: "step_output"
        prompt_template: "Help me fix these linting issues:\n\n{context}"
        ask_confirmation: true
      on_error: continue  # Don't fail if user declines AI help
